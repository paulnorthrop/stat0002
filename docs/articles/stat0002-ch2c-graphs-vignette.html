<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 2: Graphs (More Than One Variable) • stat0002</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 2: Graphs (More Than One Variable)">
<meta property="og:description" content="stat0002">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stat0002</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/stat0002-ch1a-shuttle-vignette.html">Chapter 1: The Challenger Space Shuttle Disaster</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch1b-stochastic-simulation-vignette.html">Chapter 1: Stochastic Simulation</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch1c-stochastic-simulation-vignette-2.html">Chapter 1: Stochastic Simulation 2</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2a-descriptive-statistics-vignette.html">Chapter 2: Descriptive Statistics</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (More Than One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2d-box-cox-transformation-vignette.html">Chapter 2: Transformation Of Variable</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch3-probability-vignette.html">Chapter 3: Probability</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch4-more-probability-vignette.html">Chapter 4: More Probability</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5-random-variables-vignette.html">Chapter 5: Random Variables</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch6a-discrete-random-variables-vignette.html">Chapter 6: binomial, geometric and Poisson distributions</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch6b-continous-random-variables-vignette.html">Chapter 6: uniform, exponential and normal distributions</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch6c-qq-plots-vignette.html">Chapter 6: QQ plots</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch7-statistical-inference-vignette.html">Chapter 7: Statistical Inference</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch8-contingency-tables-vignette.html">Chapter 8: Contingency tables</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch9-linear-regression-vignette.html">Chapter 9: Linear regression</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch9plus1-correlation-vignette.html">Chapter 10: Correlation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/stat0002/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 2: Graphs (More Than One Variable)</h1>
                        <h4 data-toc-skip class="author">Paul
Northrop</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/stat0002/blob/HEAD/vignettes/stat0002-ch2c-graphs-vignette.Rmd" class="external-link"><code>vignettes/stat0002-ch2c-graphs-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>stat0002-ch2c-graphs-vignette.Rmd</code></div>

    </div>

    
    
<p>The main purpose of this vignette is to provide R code to produce
graphs that involve more than one variable. We consider two general
situations: (i) plotting the values of a continuous variable for
different values of a categorical variable (see <a href="#the-oxford-birth-times-data">The Oxford Birth Times data</a>) and
(ii) scatter plots of one variable against another (see <a href="#the-2000-us-presidential-election-data">The 2000 US Presidential
Election data</a>). See also the <a href="stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (one
variable)</a>.</p>
<div class="section level2">
<h2 id="the-oxford-birth-times-data">The Oxford Birth Times data<a class="anchor" aria-label="anchor" href="#the-oxford-birth-times-data"></a>
</h2>
<p>These data are available in the data frame
<code>ox_births</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(stat0002)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> birth_times <span class="ot">&lt;-</span> ox_births[, <span class="st">"time"</span>]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> day <span class="ot">&lt;-</span> ox_births[, <span class="st">"day"</span>]</span></code></pre></div>
<p>To display these data we manipulate them into a matrix that is of the
same format as Table 2.1 in the notes. The number of birth times varies
between days so we pad the matrix with R’s missing values code
<code>NA</code> in order that each column of the matrix has the same
number of rows.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ox_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">7</span>, <span class="at">nrow =</span> <span class="dv">16</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   day_i_times <span class="ot">&lt;-</span> ox_births<span class="sc">$</span>time[<span class="fu">which</span>(ox_births<span class="sc">$</span>day <span class="sc">==</span> i)]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   ox_mat[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(day_i_times), i] <span class="ot">&lt;-</span> <span class="fu">sort</span>(day_i_times)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">colnames</span>(ox_mat) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"day"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> }  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ox_mat</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>       day1  day2  day3  day4  day5  day6  day7</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>,]  <span class="fl">2.10</span>  <span class="fl">4.00</span>  <span class="fl">2.60</span>  <span class="fl">1.50</span>  <span class="fl">2.50</span>  <span class="fl">4.00</span>  <span class="fl">2.00</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a> [<span class="dv">2</span>,]  <span class="fl">3.40</span>  <span class="fl">4.10</span>  <span class="fl">3.60</span>  <span class="fl">4.70</span>  <span class="fl">2.50</span>  <span class="fl">4.00</span>  <span class="fl">2.70</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a> [<span class="dv">3</span>,]  <span class="fl">4.25</span>  <span class="fl">5.00</span>  <span class="fl">3.60</span>  <span class="fl">4.70</span>  <span class="fl">3.40</span>  <span class="fl">5.25</span>  <span class="fl">2.75</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a> [<span class="dv">4</span>,]  <span class="fl">5.60</span>  <span class="fl">5.50</span>  <span class="fl">6.40</span>  <span class="fl">7.20</span>  <span class="fl">4.20</span>  <span class="fl">6.10</span>  <span class="fl">3.40</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>,]  <span class="fl">6.40</span>  <span class="fl">5.70</span>  <span class="fl">6.80</span>  <span class="fl">7.25</span>  <span class="fl">5.90</span>  <span class="fl">6.50</span>  <span class="fl">4.20</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a> [<span class="dv">6</span>,]  <span class="fl">7.30</span>  <span class="fl">6.50</span>  <span class="fl">7.50</span>  <span class="fl">8.10</span>  <span class="fl">6.25</span>  <span class="fl">6.90</span>  <span class="fl">4.30</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>,]  <span class="fl">8.50</span>  <span class="fl">7.25</span>  <span class="fl">7.50</span>  <span class="fl">8.50</span>  <span class="fl">7.30</span>  <span class="fl">7.00</span>  <span class="fl">4.90</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>,]  <span class="fl">8.75</span>  <span class="fl">7.30</span>  <span class="fl">8.25</span>  <span class="fl">9.20</span>  <span class="fl">7.50</span>  <span class="fl">8.45</span>  <span class="fl">6.25</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>,]  <span class="fl">8.90</span>  <span class="fl">7.50</span>  <span class="fl">8.50</span>  <span class="fl">9.50</span>  <span class="fl">7.80</span>  <span class="fl">9.25</span>  <span class="fl">7.00</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">10</span>,]  <span class="fl">9.50</span>  <span class="fl">8.20</span> <span class="fl">10.40</span> <span class="fl">10.70</span>  <span class="fl">8.30</span> <span class="fl">10.10</span>  <span class="fl">9.00</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>,]  <span class="fl">9.75</span>  <span class="fl">8.50</span> <span class="fl">10.75</span> <span class="fl">11.50</span>  <span class="fl">8.30</span> <span class="fl">10.20</span>  <span class="fl">9.25</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>[<span class="dv">12</span>,] <span class="fl">10.00</span>  <span class="fl">9.75</span> <span class="fl">14.25</span>    <span class="cn">NA</span> <span class="fl">10.25</span> <span class="fl">12.75</span> <span class="fl">10.70</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>,] <span class="fl">10.40</span> <span class="fl">11.00</span> <span class="fl">14.50</span>    <span class="cn">NA</span> <span class="fl">12.90</span> <span class="fl">14.60</span>    <span class="cn">NA</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">14</span>,] <span class="fl">10.40</span> <span class="fl">11.20</span>    <span class="cn">NA</span>    <span class="cn">NA</span> <span class="fl">14.30</span>    <span class="cn">NA</span>    <span class="cn">NA</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>[<span class="dv">15</span>,] <span class="fl">16.00</span> <span class="fl">15.00</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>[<span class="dv">16</span>,] <span class="fl">19.00</span> <span class="fl">16.50</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span>    <span class="cn">NA</span></span></code></pre></div>
<p>We have a numeric continuous variable, <code>birth_times</code>, and
a categorical variable, <code>day</code>. The following code produces
separate boxplots of <code>birth_times</code> for each day of the
week.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> xlab <span class="ot">&lt;-</span> <span class="st">"time (hours)"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x_labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(birth_times), <span class="fu">pretty</span>(birth_times), <span class="fu">max</span>(birth_times))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># top left</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">box_plot</span>(birth_times <span class="sc">~</span> day, <span class="at">col =</span> <span class="dv">8</span>, <span class="at">ylab =</span> xlab, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab =</span> <span class="st">"day"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># top right</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">box_plot</span>(birth_times <span class="sc">~</span> day, <span class="at">col =</span> <span class="dv">8</span>, <span class="at">horizontal =</span> <span class="cn">TRUE</span>,  <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> xlab, <span class="at">ylab =</span> <span class="st">"day"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> x_labs, <span class="at">labels =</span> x_labs)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">lwd =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">0</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># bottom left</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">box_plot</span>(birth_times <span class="sc">~</span> day, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">ylab =</span> xlab, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">range =</span> <span class="dv">0</span>, <span class="at">boxcol =</span> <span class="st">"white"</span>, <span class="at">staplewex =</span> <span class="dv">0</span>, <span class="at">medlty =</span> <span class="st">"blank"</span>, <span class="at">medpch =</span> <span class="dv">16</span>, <span class="at">xlab =</span> <span class="st">"day"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">lwd =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">0</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> x_labs, <span class="at">labels =</span> x_labs)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># bottom right</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">box_plot</span>(birth_times <span class="sc">~</span> day, <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> xlab, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">range =</span> <span class="dv">0</span>, <span class="at">boxcol =</span> <span class="st">"white"</span>, <span class="at">staplewex =</span> <span class="dv">0</span>, <span class="at">medlty =</span> <span class="st">"blank"</span>, <span class="at">medpch =</span> <span class="dv">16</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> x_labs, <span class="at">labels =</span> x_labs)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">lwd =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">0</span>, <span class="at">las =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-1.png" width="326.4"><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-2.png" width="326.4"><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-3.png" width="326.4"><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-4.png" width="326.4"></p>
</div>
<div class="section level2">
<h2 id="the-2000-us-presidential-election-in-florida">The 2000 US Presidential Election in Florida<a class="anchor" aria-label="anchor" href="#the-2000-us-presidential-election-in-florida"></a>
</h2>
<p>These data are available in the data frame <code>USelection</code>.
See <code><a href="../reference/USelection.html">?USelection</a></code> for details.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># County identifiers and location</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">head</span>(USelection[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  co co_names  lat  lon</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1</span>  Alachua <span class="fl">29.7</span> <span class="fl">82.4</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">2</span>    Baker <span class="fl">30.3</span> <span class="fl">82.3</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">3</span>      Bay <span class="fl">30.2</span> <span class="fl">85.6</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">4</span> Bradford <span class="fl">29.9</span> <span class="fl">82.2</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">5</span>  Brevard <span class="fl">28.3</span> <span class="fl">80.7</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">6</span>  Broward <span class="fl">26.1</span> <span class="fl">80.5</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># County demographic variables</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">head</span>(USelection[, <span class="dv">5</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>     npop whit blac hisp  o65 hsed coll  inco</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">198326</span> <span class="fl">74.4</span> <span class="fl">21.8</span>  <span class="fl">4.7</span>  <span class="fl">9.4</span> <span class="fl">82.7</span> <span class="fl">34.6</span> <span class="dv">19412</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">20761</span> <span class="fl">82.4</span> <span class="fl">16.8</span>  <span class="fl">1.5</span>  <span class="fl">7.7</span> <span class="fl">64.1</span>  <span class="fl">5.7</span> <span class="dv">14859</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">146223</span> <span class="fl">84.2</span> <span class="fl">12.4</span>  <span class="fl">2.4</span> <span class="fl">11.9</span> <span class="fl">74.7</span> <span class="fl">15.7</span> <span class="dv">17838</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">24646</span> <span class="fl">76.1</span> <span class="fl">22.9</span>  <span class="fl">2.6</span> <span class="fl">11.8</span> <span class="fl">65.0</span>  <span class="fl">8.1</span> <span class="dv">13681</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">460977</span> <span class="fl">88.3</span>  <span class="fl">9.2</span>  <span class="fl">4.1</span> <span class="fl">16.5</span> <span class="fl">82.3</span> <span class="fl">20.4</span> <span class="dv">19567</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="dv">1470758</span> <span class="fl">80.3</span> <span class="fl">17.5</span> <span class="fl">10.9</span> <span class="fl">20.3</span> <span class="fl">76.8</span> <span class="fl">18.8</span> <span class="dv">24706</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Numbers of votes for candidates</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">head</span>(USelection[, <span class="dv">13</span><span class="sc">:</span><span class="dv">22</span>])</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    bush   gore brow nade harr hage buch mcre phil moor</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">34124</span>  <span class="dv">47365</span>  <span class="dv">658</span> <span class="dv">3226</span>    <span class="dv">6</span>   <span class="dv">42</span>  <span class="dv">263</span>    <span class="dv">4</span>   <span class="dv">20</span>   <span class="dv">21</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">5610</span>   <span class="dv">2392</span>   <span class="dv">17</span>   <span class="dv">53</span>    <span class="dv">0</span>    <span class="dv">3</span>   <span class="dv">73</span>    <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">3</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">38637</span>  <span class="dv">18850</span>  <span class="dv">171</span>  <span class="dv">828</span>    <span class="dv">5</span>   <span class="dv">18</span>  <span class="dv">248</span>    <span class="dv">3</span>   <span class="dv">18</span>   <span class="dv">27</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">5414</span>   <span class="dv">3075</span>   <span class="dv">28</span>   <span class="dv">84</span>    <span class="dv">0</span>    <span class="dv">2</span>   <span class="dv">65</span>    <span class="dv">0</span>    <span class="dv">2</span>    <span class="dv">3</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="dv">115185</span>  <span class="dv">97318</span>  <span class="dv">643</span> <span class="dv">4470</span>   <span class="dv">11</span>   <span class="dv">39</span>  <span class="dv">570</span>   <span class="dv">11</span>   <span class="dv">72</span>   <span class="dv">76</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="dv">177323</span> <span class="dv">386561</span> <span class="dv">1212</span> <span class="dv">7101</span>   <span class="dv">50</span>  <span class="dv">129</span>  <span class="dv">788</span>   <span class="dv">34</span>   <span class="dv">74</span>  <span class="dv">124</span></span></code></pre></div>
<p>For the moment we simply produce some scatter plots. A separate
vignette will be devoted to these data.</p>
<p>A plot to show the locations of the counties.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(<span class="sc">-</span>USelection[, <span class="st">"lon"</span>], USelection[, <span class="st">"lat"</span>], <span class="at">xlab =</span> <span class="st">"longitude (degrees north)"</span>, <span class="at">ylab =</span> <span class="st">"latitude (degrees east)"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<ol style="list-style-type: decimal">
<li><strong>Can you see the outline of the state of
Florida?</strong></li>
</ol>
<p>A plot of the percentage of the vote for Buchanan against population
size.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> pbuch <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> USelection<span class="sc">$</span>buch<span class="sc">/</span>USelection<span class="sc">$</span>tvot</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> is_PB <span class="ot">&lt;-</span> USelection[, <span class="st">"co_names"</span>] <span class="sc">==</span> <span class="st">"PalmBeach"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> pch <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> is_PB</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> pch</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">39</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(USelection<span class="sc">$</span>npop, pbuch, <span class="at">xlab =</span> <span class="st">"population"</span>, <span class="at">ylab =</span> <span class="st">"Buchanan % vote"</span>, <span class="at">pch =</span> pch)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> which_PB <span class="ot">&lt;-</span> <span class="fu">which</span>(is_PB)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">text</span>(USelection[which_PB, <span class="st">"npop"</span>], pbuch[which_PB] <span class="sc">+</span> <span class="fl">0.1</span>, <span class="st">"Palm Beach"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Can you see how the code used to identify Palm Beach on the
plot works?</strong></li>
</ol>
<p>Pairwise scatter plots of the demographic variables.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">pairs</span>(USelection[, <span class="dv">5</span><span class="sc">:</span><span class="dv">12</span>])</span></code></pre></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>A plot of the square root of the percentage of the vote for Buchanan
against population size, in thousands of people. The horizontal axis has
been plotted on a log scale.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> USelection<span class="sc">$</span>npop <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pbuch)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ystring <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">sqrt</span>(<span class="st">"% Buchanan vote"</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> rm_PB <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span>is_PB)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">scatter</span>(x[rm_PB], y[rm_PB], <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab =</span><span class="st">"Total Population (1000s)"</span>, <span class="at">ylab =</span> ystring, <span class="at">log =</span> <span class="st">"x"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">points</span>(x[which_PB], y[which_PB], <span class="at">pch =</span> <span class="st">"X"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">text</span>(x[which_PB], y[which_PB] <span class="sc">+</span> <span class="fl">0.04</span>, <span class="st">"Palm Beach"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<ol start="3" style="list-style-type: decimal">
<li><p><strong>Can you see how the different method to identify Palm
Beach works?</strong></p></li>
<li><p><strong>Can you guess what the numbers on the axes are? See
<code>scatter</code> to find out.</strong></p></li>
</ol>
<p>Similarly, we use <code>scatter_hist</code> to create a scatter plot
in which the distribution of each variable is summarized by a
histogram.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">scatter_hist</span>(x, y, <span class="at">log =</span> <span class="st">"x"</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab =</span><span class="st">"Total Population (1000s)"</span>, <span class="at">ylab =</span> ystring)</span></code></pre></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>The plot in the lecture slides is produced by specifying particular
bins for the histograms.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> logx <span class="ot">&lt;-</span> <span class="fu">log</span>(x)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> xbreaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(logx), <span class="at">to =</span> <span class="fu">max</span>(logx), <span class="at">len =</span> <span class="dv">25</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ybreaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(y), <span class="at">to =</span> <span class="fu">max</span>(y), <span class="at">len =</span> <span class="dv">25</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">scatter_hist</span>(x, y, <span class="at">log =</span> <span class="st">"x"</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab =</span><span class="st">"Total Population (1000s)"</span>, <span class="at">ylab =</span> ystring, <span class="at">xbreaks =</span> xbreaks, <span class="at">ybreaks =</span> ybreaks)</span></code></pre></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
