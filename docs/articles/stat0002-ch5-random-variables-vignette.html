<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5: Random Variables â€¢ stat0002</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 5: Random Variables">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stat0002</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/stat0002-ch1a-shuttle-vignette.html">Chapter 1: The Challenger Space Shuttle Disaster</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch1b-stochastic-simulation-vignette.html">Chapter 1: Stochastic Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch1c-stochastic-simulation-vignette-2.html">Chapter 1: Stochastic Simulation 2</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch2a-descriptive-statistics-vignette.html">Chapter 2: Descriptive Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (One Variable)</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (More Than One Variable)</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch2d-box-cox-transformation-vignette.html">Chapter 2: Transformation Of Variable</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch3-probability-vignette.html">Chapter 3: Probability</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch4-more-probability-vignette.html">Chapter 4: More Probability</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch5-random-variables-vignette.html">Chapter 5: Random Variables</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch6a-discrete-random-variables-vignette.html">Chapter 6: binomial, geometric and Poisson distributions</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch6b-continous-random-variables-vignette.html">Chapter 6: uniform, exponential and normal distributions</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch6c-qq-plots-vignette.html">Chapter 6: QQ plots</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch7-statistical-inference-vignette.html">Chapter 7: Statistical Inference</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch8-contingency-tables-vignette.html">Chapter 8: Contingency tables</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch9-linear-regression-vignette.html">Chapter 9: Linear regression</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch9plus1-correlation-vignette.html">Chapter 10: Correlation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/stat0002/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Chapter 5: Random Variables</h1>
                        <h4 data-toc-skip class="author">Paul
Northrop</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/stat0002/blob/HEAD/vignettes/stat0002-ch5-random-variables-vignette.Rmd"><code>vignettes/stat0002-ch5-random-variables-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>stat0002-ch5-random-variables-vignette.Rmd</code></div>
    </div>

    
    
<p>This vignette provides some R code that is related to some of the
content of <a href="https://paulnorthrop.github.io/stat0002book/rvs.html" class="external-link">Chapter 5 of
the STAT0002 notes</a>, namely to random variables and their
properties.</p>
<div class="section level2">
<h2 id="discrete-random-variables">Discrete random variables<a class="anchor" aria-label="anchor" href="#discrete-random-variables"></a>
</h2>
<p>We look at two example discrete random variables and consider how to
find their respective modes, medians and means.</p>
<div class="section level3">
<h3 id="an-example-with-finite-support">An example with finite support<a class="anchor" aria-label="anchor" href="#an-example-with-finite-support"></a>
</h3>
<p>Consider the random variable <span class="math inline">\(X\)</span>
with support <span class="math inline">\(\{ 0, 1, 2 \}\)</span> and
p.m.f. satisfying</p>
<p><span class="math display">\[ P(X=0)=\frac16 \qquad  P(X=1)=\frac12
\qquad P(X=2)=\frac13. \]</span></p>
<p>The following code produces plots of the p.m.f. and c.d.f. of <span class="math inline">\(X\)</span>, fiddling with the basic plots to
produce a slightly prettier ones.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Plot the p.m.f.</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="er">&gt;</span> x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="sc">&gt;</span> px <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(x, px, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">ylab =</span> <span class="st">"P(X = x)"</span>, <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="sc">+</span>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>), <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>, <span class="at">cex.axis =</span> <span class="fl">1.5</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">sort</span>(px)), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1/6"</span>, <span class="st">"1/3"</span>, <span class="st">"1/2"</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="stat0002-ch5-random-variables-vignette_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Plot c.d.f.</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="er">&gt;</span> x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="sc">&gt;</span> y0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="sc">&gt;</span> x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">2.5</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="sc">&gt;</span> y1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(<span class="fu">c</span>(x0, x1), <span class="fu">c</span>(y0, y1), <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>, </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="sc">+</span>      <span class="at">cex.axis =</span> <span class="fl">1.5</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">segments</span>(x0, y0, x1, y1, <span class="at">lty =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">0</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">pos =</span> <span class="dv">0</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">0</span>, px)), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1/6"</span>, <span class="st">"2/3"</span>, <span class="st">"1"</span>), <span class="at">las =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">title</span>(<span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"P(X"</span><span class="sc">&lt;=</span><span class="st">"x)"</span>), <span class="at">cex.lab =</span> <span class="fl">1.5</span>, <span class="at">line =</span> <span class="fl">2.5</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Add lines to indicate the median of X</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="st">"1/2"</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">segments</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">segments</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="stat0002-ch5-random-variables-vignette_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The plot of the p.m.f. shows that the mode of <span class="math inline">\(X\)</span> is 1 and the plot of the c.d.f. that
the median of <span class="math inline">\(X\)</span> is 1. This random
variable has finite support. Therefore, its mean <span class="math inline">\(\text{E}(X)\)</span> exists. We could calculate
<span class="math inline">\(\text{E}(X)\)</span> using the following
code.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">sum</span>(x <span class="sc">*</span> px)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.166667</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="an-example-with-infinite-support">An example with infinite support<a class="anchor" aria-label="anchor" href="#an-example-with-infinite-support"></a>
</h3>
<p>Consider the function <span class="math display">\[ p(x) = P(X = x) =
\frac{6}{\pi^2} \frac{1}{x^2}, \quad \mbox{ for } x = 1, 2, 3,\,
....\]</span></p>
<p>This is a valid p.m.f. of a discrete random variable <span class="math inline">\(X\)</span>, because</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(p(x) \geq 0\)</span> for <span class="math inline">\(x = 1, 2, 3,\, ...\)</span>
</li>
<li>
<span class="math inline">\(\sum_{x=1}^{\infty} p(x) = 1\)</span>
(<a href="https://en.wikipedia.org/wiki/Basel_problem" class="external-link">Basel
problem</a>)</li>
</ol>
<p>To illustrate 2. look at the following output and plot.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>m</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="sc">&gt;</span> px <span class="ot">&lt;-</span> (<span class="dv">6</span> <span class="sc">/</span> pi <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> x <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="sc">&gt;</span> mat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, x), <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">0</span>, px)))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(mat[, <span class="dv">1</span>], mat[, <span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">ann  =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">title</span>(<span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">P</span>(X <span class="sc">&lt;=</span> x)))</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="stat0002-ch5-random-variables-vignette_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">tail</span>(mat)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>       [,<span class="dv">1</span>]      [,<span class="dv">2</span>]</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a> [<span class="dv">96</span>,]   <span class="dv">95</span> <span class="fl">0.9936343</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a> [<span class="dv">97</span>,]   <span class="dv">96</span> <span class="fl">0.9937003</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a> [<span class="dv">98</span>,]   <span class="dv">97</span> <span class="fl">0.9937649</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a> [<span class="dv">99</span>,]   <span class="dv">98</span> <span class="fl">0.9938282</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>[<span class="dv">100</span>,]   <span class="dv">99</span> <span class="fl">0.9938902</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>[<span class="dv">101</span>,]  <span class="dv">100</span> <span class="fl">0.9939510</span></span></code></pre></div>
<p><strong>Can you find the median, mode and mean of <span class="math inline">\(X\)</span>?</strong></p>
<p>You will have trouble finding the mean because <span class="math inline">\(S = \sum_{x=1}^{\infty} x p(x)\)</span> does not
converge. Suppose that we try to approximate the value of this sum using
<span class="math inline">\(\hat{S}(m) = \sum_{x=1}^{m} x p(x)\)</span>
for some large value <span class="math inline">\(m\)</span>. The
following code plots the <span class="math inline">\(\hat{S}(m)\)</span>
against <span class="math inline">\(m\)</span> for <span class="math inline">\(m = 1,..., 100\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="sc">&gt;</span> m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="sc">&gt;</span> x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>m</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="sc">&gt;</span> px <span class="ot">&lt;-</span> (<span class="dv">6</span> <span class="sc">/</span> pi <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> x <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="sc">&gt;</span> s <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(x <span class="sc">*</span> px)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(x, s, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">ann =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">title</span>(<span class="at">xlab =</span> <span class="st">"m"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">title</span>(<span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(S)(m)), <span class="at">line =</span> <span class="fl">2.25</span>)</span></code></pre></div>
<p><img src="stat0002-ch5-random-variables-vignette_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Does it look like <span class="math inline">\(\hat{S}(m)\)</span> is
converging as <span class="math inline">\(m \rightarrow \infty\)</span>?
You could try some larger values of <span class="math inline">\(m\)</span> to investigate. You could also examine
<span class="math inline">\(\sum_{x=1}^{\infty} x p(x)\)</span>
algebraically. Does it involve an example series that you have seen
before? Is this series convergent or divergent?</p>
<p>This distribution is a special case of a <a href="https://en.wikipedia.org/wiki/Zeta_distribution" class="external-link">Zeta
distribution</a>, where a parameter <span class="math inline">\(s=
2\)</span>. This distribution has a (finite) mean only if <span class="math inline">\(s &gt; 2\)</span>. If <span class="math inline">\(s \in (1, 2]\)</span> then we can argue either
that this distribution has no mean or that it has an infinite mean. If
we simulate samples of finite size from a Zeta distribution with <span class="math inline">\(s = 2\)</span> then we can calculate the sample
means of these samples. However, these sample means are of little use to
us because this distribution does not have a finite mean. The values of
these sample means are liable to be influenced by the values of the
largest sample values which may be very large. The <code>VGAM</code> R
package has a function <code>rzeta</code> that simulates samples from a
Zeta distribution. If you would like to explore how these sample means
behave then you can use the code below. You could repeat this a few
times and look at how the sample means vary. When using the
<code>VGAM</code> package setting the argument <code>shape = 1</code>
corresponds to the distribution that we have considered.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Install VGAM</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">install.packages</span>(<span class="st">"VGAM"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Load VGAM</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">library</span>(VGAM)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Simulate a sample of size 100</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="er">&gt;</span> x <span class="ot">&lt;-</span> <span class="fu">rzeta</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">shape =</span> <span class="dv">1</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Calculate the sample mean</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">mean</span>(x)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="continuous-random-variables">Continuous random variables<a class="anchor" aria-label="anchor" href="#continuous-random-variables"></a>
</h2>
<p>We look at a continuous random variable that may be used to model the
Oxford birth times data and consider how to calculate the mode, median
and mean of this random variable.</p>
<div class="section level3">
<h3 id="a-simple-model-for-the-oxford-birth-times">A simple model for the Oxford birth times<a class="anchor" aria-label="anchor" href="#a-simple-model-for-the-oxford-birth-times"></a>
</h3>
<p>The plot in the bottom of <a href="https://paulnorthrop.github.io/stat0002book/rvs.html#fig:oxshady" class="external-link">Figure
5.2</a> of the notes is of the p.d.f. of a gamma distribution with
parameters chosen so that the shape of the p.d.f. is similar to that of
the histogram of the times in the Oxford Birth Times dataset. To find
out about the gamma distribution type <code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">?GammaDist</a></code>. The
following code finds values of the shape parameter <span class="math inline">\(\alpha\)</span> and scale parameter <span class="math inline">\(\sigma\)</span> for which the mean and variance of
the gamma distribution are equal, respectively, to the sample mean and
sample variance of the Oxford birth times data.</p>
<p><strong>Can you see how this works?</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(stat0002)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="sc">&gt;</span> tbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(ox_births<span class="sc">$</span>time)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="sc">&gt;</span> vart <span class="ot">&lt;-</span> <span class="fu">var</span>(ox_births<span class="sc">$</span>time)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Sample mean and variance</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">c</span>(tbar, vart)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">7.723158</span> <span class="fl">12.731320</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="sc">&gt;</span> scale_par <span class="ot">&lt;-</span> vart <span class="sc">/</span> tbar</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="sc">&gt;</span> shape_par <span class="ot">&lt;-</span> tbar <span class="sc">/</span> scale_par</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Estimates of gamma shape and scale parameters</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">c</span>(shape_par, scale_par)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">4.685073</span> <span class="fl">1.648460</span></span></code></pre></div>
<p>We produce a basic plot of the gamma distribution that we have fitted
to these data, to check that it has done what we expected. If <span class="math inline">\(\alpha\)</span> is greater than 1 then the mode of
a gamma(<span class="math inline">\(\alpha, \sigma\)</span>)
distribution is at <span class="math inline">\((\alpha - 1)
\sigma\)</span>. We add a vertical line at the mode to check this.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Produce the plot</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">curve</span>(<span class="fu">dgamma</span>(x, <span class="at">shape =</span> shape_par, <span class="at">scale =</span> scale_par), <span class="dv">0</span>, <span class="dv">20</span>, <span class="at">ylab =</span> <span class="st">"p.d.f."</span>, <span class="at">xlab =</span> <span class="st">"time (hours)"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="sc">&gt;</span> gmode <span class="ot">&lt;-</span> (shape_par <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> scale_par</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="sc">&gt;</span> gmode</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">6.074698</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Indicate the mode</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">segments</span>(gmode, <span class="dv">0</span>, gmode, <span class="fu">dgamma</span>(gmode, <span class="at">shape =</span> shape_par, <span class="at">scale =</span> scale_par), <span class="at">lty =</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="stat0002-ch5-random-variables-vignette_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="a-digression-about-numerical-optimisation">A digression about numerical optimisation<a class="anchor" aria-label="anchor" href="#a-digression-about-numerical-optimisation"></a>
</h3>
<p>If we did not know how to find the mode using the values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\sigma\)</span> then we could try to find it
numerically by searching for the point at which the p.d.f. is maximised.
For functions like this it is common to seek to maximise the
<strong>log</strong> of the p.d.f.. In practice, optimisation
algorithms, like the function <code>optim</code> used below, are often
set up to <strong>minimise</strong> a function by default. Here we set
the control option <code>fnscale</code> to <code>-1</code> to multiply
the target function by <span class="math inline">\(-1\)</span>, turning
our maximisation problem into a minimisation problem.</p>
<p>Note the use of <code>...</code> to pass the values of
<code>shape</code>, <code>scale</code> and <code>log</code> to the
function <code>fn</code>. Also, <code>method = "L-BFGS-B"</code> chooses
an optimisation method that allows us to set bounds on the solution and
<code>lower = 0</code> gives the information that we know that the mode
cannot be less than zero.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># A function to calculate the (log of the) gamma p.d.f.</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="er">&gt;</span> fn <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) <span class="fu">dgamma</span>(x, ...)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="sc">&gt;</span> find_mode <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="dv">1</span>, fn, <span class="at">shape =</span> shape_par, <span class="at">scale =</span> scale_par, <span class="at">log =</span> <span class="cn">TRUE</span>, </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">method =</span> <span class="st">"L-BFGS-B"</span>, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Approximate value of the mode</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="er">&gt;</span> find_mode<span class="sc">$</span>par</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">6.074697</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Value of the p.d.f. at this value</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">exp</span>(find_mode<span class="sc">$</span>value)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1232569</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="a-digression-about-numerical-integration">A digression about numerical integration<a class="anchor" aria-label="anchor" href="#a-digression-about-numerical-integration"></a>
</h3>
<p>It can be shown algebraically that the gamma p.d.f. integrates to 1.
(This must be true otherwise it is not a p.d.f..) R has a function
called <code>integrate</code> that performs numerical integration to
estimate the value of an integral. The code below uses
<code>integrate</code> to check that this gamma p.d.f. integrates to 1
over <span class="math inline">\((0, \infty)\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Check that the p.d.f. integrates to 1</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">integrate</span>(dgamma, <span class="dv">0</span>, <span class="cn">Inf</span>, <span class="at">shape =</span> shape_par, <span class="at">scale =</span> scale_par)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="dv">1</span> with absolute error <span class="sc">&lt;</span> <span class="fl">1.1e-08</span></span></code></pre></div>
<p>We could also use <code>integrate</code> to check that our fitted
gamma distribution has the mean that we expect. Note that the
<code>...</code> in the definition of the function
<code>integrand</code> that calculates the integrand can be used to pass
the arguments <code>shape</code> and/or <code>scale</code> to the
function <code>dgamma</code> that calculates the p.d.f. of a gamma
distribution.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Check that the gamma mean is equal to the sample mean, tbar, of the data</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="er">&gt;</span> integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) x <span class="sc">*</span> <span class="fu">dgamma</span>(x, ...)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">integrate</span>(integrand, <span class="dv">0</span>, <span class="cn">Inf</span>, <span class="at">shape =</span> shape_par, <span class="at">scale =</span> scale_par)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fl">7.723158</span> with absolute error <span class="sc">&lt;</span> <span class="fl">3e-07</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="sc">&gt;</span> tbar</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">7.723158</span></span></code></pre></div>
<p>The <code>qgamma</code> function can be used to calculate quantiles
of a given gamma distribution. Suppose that we wish to calculate the
median (the <span class="math inline">\(50\%\)</span> quantile) of our
fitted gamma distribution. The following code does this. It also shows
that we can calculate more than one quantile at a time.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="sc">&gt;</span> tmedian <span class="ot">&lt;-</span> <span class="fu">qgamma</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">shape =</span> shape_par, <span class="at">scale =</span> scale_par)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="sc">&gt;</span> tmedian</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">7.181169</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">qgamma</span>(<span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>), <span class="at">shape =</span> shape_par, <span class="at">scale =</span> scale_par)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">2.926326</span>  <span class="fl">7.181169</span> <span class="fl">14.370700</span></span></code></pre></div>
<p>We could use <code>integrate</code> to check that <code>qgamma</code>
has returned the correct median, or use the function
<code>pgamma</code>, which calculates the c.d.f. of a gamma random
variable.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Two ways to check that the median is correct</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">integrate</span>(dgamma, <span class="dv">0</span>, tmedian, <span class="at">shape =</span> shape_par, <span class="at">scale =</span> scale_par)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fl">0.5</span> with absolute error <span class="sc">&lt;</span> <span class="fl">1.1e-08</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">pgamma</span>(tmedian, <span class="at">shape =</span> shape_par, <span class="at">scale =</span> scale_par)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5</span></span></code></pre></div>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
