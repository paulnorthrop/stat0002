<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4: More Probability • stat0002</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 4: More Probability">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stat0002</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/stat0002-ch1a-shuttle-vignette.html">Chapter 1: The Challenger Space Shuttle Disaster</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch1b-stochastic-simulation-vignette.html">Chapter 1: Stochastic Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch1c-stochastic-simulation-vignette-2.html">Chapter 1: Stochastic Simulation 2</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch2a-descriptive-statistics-vignette.html">Chapter 2: Descriptive Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (One Variable)</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (More Than One Variable)</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch2d-box-cox-transformation-vignette.html">Chapter 2: Transformation Of Variable</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch3-probability-vignette.html">Chapter 3: Probability</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch4-more-probability-vignette.html">Chapter 4: More Probability</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch5-random-variables-vignette.html">Chapter 5: Random Variables</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch6a-discrete-random-variables-vignette.html">Chapter 6: binomial, geometric and Poisson distributions</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch6b-continous-random-variables-vignette.html">Chapter 6: uniform, exponential and normal distributions</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch6c-qq-plots-vignette.html">Chapter 6: QQ plots</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch7-statistical-inference-vignette.html">Chapter 7: Statistical Inference</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch8-contingency-tables-vignette.html">Chapter 8: Contingency tables</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch9-linear-regression-vignette.html">Chapter 9: Linear regression</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-ch9plus1-correlation-vignette.html">Chapter 10: Correlation</a></li>
    <li><a class="dropdown-item" href="../articles/stat0002-creating-pdf-files-vignette.html">Creating PDF files using R markdown</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/stat0002/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Chapter 4: More Probability</h1>
                        <h4 data-toc-skip class="author">Paul
Northrop</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/stat0002/blob/HEAD/vignettes/stat0002-ch4-more-probability-vignette.Rmd"><code>vignettes/stat0002-ch4-more-probability-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>stat0002-ch4-more-probability-vignette.Rmd</code></div>
    </div>

    
    
<p>This vignette provides some R code that is related to some of the
content of <a href="https://paulnorthrop.github.io/stat0002book/more-probability.html" class="external-link">Chapter
4 of the STAT0002 notes</a>, namely to Bayes’ theorem.</p>
<div class="section level2">
<h2 id="a-screening-test">A screening test<a class="anchor" aria-label="anchor" href="#a-screening-test"></a>
</h2>
<p>A classic application of Bayes’ theorem arises in screening for a
disease of condition. This <strong>screening test</strong> does not
determine whether or not the person has the disease. It is used to
identify individuals who have a relatively high probability of having
the disease and therefore may benefit from a more definitive
<strong>diagnostic test</strong>.</p>
<div class="section level3">
<h3 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h3>
<p>Consider a person selected at random from a population to take the
screening test. Let</p>
<ul>
<li>
<span class="math inline">\(D\)</span> be the event that they have
the disease;</li>
<li>
<span class="math inline">\(+\)</span> be the event that they test
positive for the disease;</li>
<li>
<span class="math inline">\(-\)</span> be the event that they test
negative for the disease.</li>
</ul>
</div>
<div class="section level3">
<h3 id="properties-of-the-test">Properties of the test<a class="anchor" aria-label="anchor" href="#properties-of-the-test"></a>
</h3>
<p>The mathematical properties of the test are governed by the following
probabilities:</p>
<ul>
<li>the <strong>sensitivity</strong> or <strong>true positive
rate</strong>, the probability <span class="math inline">\(P(+ \mid
D)\)</span> that a person who has the disease tests positive;</li>
<li>the *specificity<strong> or </strong>true negative rate**, the
probability <span class="math inline">\(P(- \mid \text{not}D)\)</span>
that a person who does not have the disease tests negative.</li>
</ul>
</div>
<div class="section level3">
<h3 id="use-of-bayes-theorem">Use of Bayes’ theorem<a class="anchor" aria-label="anchor" href="#use-of-bayes-theorem"></a>
</h3>
<p>What matters to a person who takes the test is their probability of
having the disease given the result of their test. We use Bayes’ theorem
to calculate the relevant probabilities. These probabilities depend on
the pre-test, or <strong>prior</strong>, probability <span class="math inline">\(P(D)\)</span> that the person has the disease. In
the current context, where the person is selected at random from a
population, <span class="math inline">\(P(D)\)</span> is the proportion
of population who have the disease.</p>
</div>
</div>
<div class="section level2">
<h2 id="an-example-type-2-diabetes">An example: type 2 diabetes<a class="anchor" aria-label="anchor" href="#an-example-type-2-diabetes"></a>
</h2>
<p>A screening test for type 2 diabetes (hereafter referred to simply as
diabetes) is based on blood glucose levels after a 12-hour period of
fasting. A person tests positive for diabetes if their fasting blood
glucose level is greater than 6.5 mmol/L. Among people with untreated
diabetes the probability <span class="math inline">\(P(+ \mid
D)\)</span> is <span class="math inline">\(0.933\)</span>. Among people
who do not have diabetes the probability <span class="math inline">\(P(+
\mid \text{not}D) = 0.020\)</span> is much smaller, so that the
sensitivity <span class="math inline">\(P(- \mid \text{not}D)\)</span>
of the test is <span class="math inline">\(1 - 0.020 =
0.98\)</span>.</p>
<p>We suppose in a population of interest, perhaps people over 50 years
of age, that <span class="math inline">\(P(D) = 0.03\)</span>, that is,
<span class="math inline">\(3\%\)</span> of this population have type 2
diabetes.</p>
<p><strong>If a person tests positive then what is their probability of
having diabetes?</strong></p>
<p>Bayes’ theorem gives</p>
<p><span class="math display">\[P(D \mid +)
= \frac{P(+ \mid D) P(D)}{P(+)}
= \frac{P(+ \mid D) P(D)}{P(+ \mid D) P(D) + P(+ \mid \text{not}D)
P(\text{not}D)},\]</span></p>
<p>where we have used the law of total probability in the denominator.
Substituting the values of the probabilities, noting that <span class="math inline">\(P(\text{not}D) = 1 - 0.03\)</span>, gives</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fl">0.933</span> <span class="sc">*</span> <span class="fl">0.03</span> <span class="sc">/</span> (<span class="fl">0.933</span> <span class="sc">*</span> <span class="fl">0.03</span> <span class="sc">+</span> <span class="fl">0.020</span> <span class="sc">*</span> <span class="fl">0.97</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5906309</span></span></code></pre></div>
<p><strong>If a person tests negative then what is their probability of
not having diabetes?</strong></p>
<p>Bayes’ theorem gives</p>
<p><span class="math display">\[P(\text{not}D \mid -)
= \frac{P(- \mid \text{not}D) P(\text{not}D)}{P(-)}
= \frac{P(- \mid \text{not}D) P(\text{not}D)}{P(- \mid \text{not}D)
P(\text{not}D) + P(- \mid D) P(D)},\]</span></p>
<p>where <span class="math inline">\(P(- \mid D) = 1 - P(+ \mid D) = 1 -
0.933 = 0.067\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fl">0.98</span> <span class="sc">*</span> <span class="fl">0.97</span> <span class="sc">/</span> (<span class="fl">0.98</span> <span class="sc">*</span> <span class="fl">0.97</span> <span class="sc">+</span> <span class="fl">0.067</span> <span class="sc">*</span> <span class="fl">0.03</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.99789</span></span></code></pre></div>
<div class="section level3">
<h3 id="the-screening_test-function">The <code>screening_test</code> function<a class="anchor" aria-label="anchor" href="#the-screening_test-function"></a>
</h3>
<p>The <code>stat0002</code> R package has a function
<code>screening_test</code> that performs these calculations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(stat0002)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">screening_test</span>(<span class="at">prior =</span> <span class="fl">0.03</span>, <span class="at">sensitivity =</span> <span class="fl">0.933</span>, <span class="at">specificity =</span> <span class="fl">0.98</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>Prevalence, sensitivity, specificity<span class="sc">:</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>       <span class="fu">P</span>(D)     <span class="fu">P</span>(<span class="sc">+</span> <span class="er">|</span> D)  <span class="fu">P</span>(<span class="sc">-</span> <span class="er">|</span> notD)  </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>      <span class="fl">0.030</span>        <span class="fl">0.933</span>        <span class="fl">0.980</span>  </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">P</span>(positive test), positive and negative predictive values<span class="sc">:</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>       <span class="fu">P</span>(<span class="sc">+</span>)     <span class="fu">P</span>(D <span class="sc">|</span> <span class="sc">+</span>)  <span class="fu">P</span>(notD <span class="sc">|</span> <span class="sc">-</span>)  </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="fl">0.04739</span>      <span class="fl">0.59063</span>      <span class="fl">0.99789</span>  </span></code></pre></div>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
