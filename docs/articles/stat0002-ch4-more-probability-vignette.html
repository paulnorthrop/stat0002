<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 4: More Probability • stat0002</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 4: More Probability">
<meta property="og:description" content="stat0002">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stat0002</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/stat0002-ch1a-shuttle-vignette.html">Chapter 1: The Challenger Space Shuttle Disaster</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch1b-stochastic-simulation-vignette.html">Chapter 1: Stochastic Simulation</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2a-descriptive-statistics-vignette.html">Chapter 2: Descriptive Statistics</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (More Than One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2d-box-cox-transformation-vignette.html">Chapter 2: Transformation Of Variable</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch3-probability-vignette.html">Chapter 3: Probability</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch4-more-probability-vignette.html">Chapter 4: More Probability</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5-random-variables-vignette.html">Chapter 5: Random Variables</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch6a-discrete-random-variables-vignette.html">Chapter 6: binomial, geometric and Poisson distributions</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch6b-continous-random-variables-vignette.html">Chapter 6: uniform, exponential and normal distributions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/stat0002/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 4: More Probability</h1>
                        <h4 data-toc-skip class="author">Paul
Northrop</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/stat0002/blob/HEAD/vignettes/stat0002-ch4-more-probability-vignette.Rmd" class="external-link"><code>vignettes/stat0002-ch4-more-probability-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>stat0002-ch4-more-probability-vignette.Rmd</code></div>

    </div>

    
    
<p>This vignette provides some R code that is related to some of the
content of <a href="https://paulnorthrop.github.io/stat0002book/more-probability.html" class="external-link">Chapter
4 of the STAT0002 notes</a>, namely to Bayes’ theorem.</p>
<div class="section level2">
<h2 id="a-screening-test">A screening test<a class="anchor" aria-label="anchor" href="#a-screening-test"></a>
</h2>
<p>A classic application of Bayes’ theorem arises in screening for a
disease of condition. This <strong>screening test</strong> does not
determine whether or not the person has the disease. It is used to
identify individuals who have a relatively high probability of having
the disease and therefore may benefit from a more definitive
<strong>diagnostic test</strong>.</p>
<div class="section level3">
<h3 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h3>
<p>Consider a person selected at random from a population to take the
screening test. Let</p>
<ul>
<li>
<span class="math inline">\(D\)</span> be the event that they have
the disease;</li>
<li>
<span class="math inline">\(+\)</span> be the event that they test
positive for the disease;</li>
<li>
<span class="math inline">\(-\)</span> be the event that they test
negative for the disease.</li>
</ul>
</div>
<div class="section level3">
<h3 id="properties-of-the-test">Properties of the test<a class="anchor" aria-label="anchor" href="#properties-of-the-test"></a>
</h3>
<p>The mathematical properties of the test are governed by the following
probabilities:</p>
<ul>
<li>the <strong>sensitivity</strong> or <strong>true positive
rate</strong>, the probability <span class="math inline">\(P(+ \mid
D)\)</span> that a person who has the disease tests positive;</li>
<li>the *specificity<strong> or </strong>true negative rate**, the
probability <span class="math inline">\(P(- \mid \text{not}D)\)</span>
that a person who does not have the disease tests negative.</li>
</ul>
</div>
<div class="section level3">
<h3 id="use-of-bayes-theorem">Use of Bayes’ theorem<a class="anchor" aria-label="anchor" href="#use-of-bayes-theorem"></a>
</h3>
<p>What matters to a person who takes the test is their probability of
having the disease given the result of their test. We use Bayes’ theorem
to calculate the relevant probabilities. These probabilities depend on
the pre-test, or <strong>prior</strong>, probability <span class="math inline">\(P(D)\)</span> that the person has the disease. In
the current context, where the person is selected at random from a
population, <span class="math inline">\(P(D)\)</span> is the proportion
of population who have the disease.</p>
</div>
</div>
<div class="section level2">
<h2 id="an-example-type-2-diabetes">An example: type 2 diabetes<a class="anchor" aria-label="anchor" href="#an-example-type-2-diabetes"></a>
</h2>
<p>A screening test for type 2 diabetes (hereafter referred to simply as
diabetes) is based on blood glucose levels after a 12-hour period of
fasting. A person tests positive for diabetes if their fasting blood
glucose level is greater than 6.5 mmol/L. Among people with untreated
diabetes the probability <span class="math inline">\(P(+ \mid
D)\)</span> is <span class="math inline">\(0.933\)</span>. Among people
who do not have diabetes the probability <span class="math inline">\(P(+
\mid \text{not}D) = 0.020\)</span> is much smaller, so that the
sensitivity <span class="math inline">\(P(- \mid \text{not}D)\)</span>
of the test is <span class="math inline">\(1 - 0.020 =
0.98\)</span>.</p>
<p>We suppose in a population of interest, perhaps people over 50 years
of age, that <span class="math inline">\(P(D) = 0.03\)</span>, that is,
<span class="math inline">\(3\%\)</span> of this population have type 2
diabetes.</p>
<p><strong>If a person tests positive then what is their probability of
having diabetes?</strong></p>
<p>Bayes’ theorem gives</p>
<p><span class="math display">\[P(D \mid +)
= \frac{P(+ \mid D) P(D)}{P(+)}
= \frac{P(+ \mid D) P(D)}{P(+ \mid D) P(D) + P(+ \mid \text{not}D)
P(\text{not}D)},\]</span></p>
<p>where we have used the law of total probability in the denominator.
Substituting the values of the probabilities, noting that <span class="math inline">\(P(\text{not}D) = 1 - 0.03\)</span>, gives</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fl">0.933</span> <span class="sc">*</span> <span class="fl">0.03</span> <span class="sc">/</span> (<span class="fl">0.933</span> <span class="sc">*</span> <span class="fl">0.03</span> <span class="sc">+</span> <span class="fl">0.020</span> <span class="sc">*</span> <span class="fl">0.97</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5906309</span></span></code></pre></div>
<p><strong>If a person tests negative then what is their probability of
not having diabetes?</strong></p>
<p>Bayes’ theorem gives</p>
<p><span class="math display">\[P(\text{not}D \mid -)
= \frac{P(- \mid \text{not}D) P(\text{not}D)}{P(-)}
= \frac{P(- \mid \text{not}D) P(\text{not}D)}{P(- \mid \text{not}D)
P(\text{not}D) + P(- \mid D) P(D)},\]</span></p>
<p>where <span class="math inline">\(P(- \mid D) = 1 - P(+ \mid D) = 1 -
0.933 = 0.067\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fl">0.98</span> <span class="sc">*</span> <span class="fl">0.97</span> <span class="sc">/</span> (<span class="fl">0.98</span> <span class="sc">*</span> <span class="fl">0.97</span> <span class="sc">+</span> <span class="fl">0.067</span> <span class="sc">*</span> <span class="fl">0.03</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.99789</span></span></code></pre></div>
<div class="section level3">
<h3 id="the-screening_test-function">The <code>screening_test</code> function<a class="anchor" aria-label="anchor" href="#the-screening_test-function"></a>
</h3>
<p>The <code>stat0002</code> R package has a function
<code>screening_test</code> that performs these calculations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(stat0002)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">screening_test</span>(<span class="at">prior =</span> <span class="fl">0.03</span>, <span class="at">sensitivity =</span> <span class="fl">0.933</span>, <span class="at">specificity =</span> <span class="fl">0.98</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Prevalence, sensitivity, specificity<span class="sc">:</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">P</span>(D)     <span class="fu">P</span>(<span class="sc">+</span> <span class="er">|</span> D)  <span class="fu">P</span>(<span class="sc">-</span> <span class="er">|</span> notD)  </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.030</span>        <span class="fl">0.933</span>        <span class="fl">0.980</span>  </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">P</span>(positive test), positive and negative predictive values<span class="sc">:</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">P</span>(<span class="sc">+</span>)     <span class="fu">P</span>(D <span class="sc">|</span> <span class="sc">+</span>)  <span class="fu">P</span>(notD <span class="sc">|</span> <span class="sc">-</span>)  </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.04739</span>      <span class="fl">0.59063</span>      <span class="fl">0.99789</span>  </span></code></pre></div>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
