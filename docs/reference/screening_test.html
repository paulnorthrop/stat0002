<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Screening test calculations — screening_test • stat0002</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Screening test calculations — screening_test"><meta property="og:description" content="Consider a screening test for a certain disease or condition, applied to a
person who has a certain prior, pre-test probability of having the disease.
For such a person this function calculates the probabilities that: the
person has the disease given that they test positive; the person does not
have the disease given that they test negative."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stat0002</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/stat0002-ch1a-shuttle-vignette.html">Chapter 1: The Challenger Space Shuttle Disaster</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch1b-stochastic-simulation-vignette.html">Chapter 1: Stochastic Simulation</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2a-descriptive-statistics-vignette.html">Chapter 2: Descriptive Statistics</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (More Than One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2d-box-cox-transformation-vignette.html">Chapter 2: Transformation Of Variable</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch3-probability-vignette.html">Chapter 3: Probability</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch4-more-probability-vignette.html">Chapter 4: More Probability</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5-random-variables-vignette.html">Chapter 5: Random Variables</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch6a-discrete-random-variables-vignette.html">Chapter 6: binomial, geometric and Poisson distributions</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch6b-continous-random-variables-vignette.html">Chapter 6: uniform, exponential and normal distributions</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch6c-qq-plots-vignette.html">Chapter 6: QQ plots</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch7-statistical-inference-vignette.html">Chapter 7: Statistical Inference</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch8-contingency-tables-vignette.html">Chapter 8: Contingency tables</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch9-linear-regression-vignette.html">Chapter 9: Linear regression</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch9plus1-correlation-vignette.html">Chapter 10: Correlation</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paulnorthrop/stat0002/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Screening test calculations</h1>
    <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/stat0002/blob/HEAD/R/screening_test.R" class="external-link"><code>R/screening_test.R</code></a></small>
    <div class="hidden name"><code>screening_test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Consider a screening test for a certain disease or condition, applied to a
person who has a certain prior, pre-test probability of having the disease.
For such a person this function calculates the probabilities that: the
person has the disease given that they test positive; the person does not
have the disease given that they test negative.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">screening_test</span><span class="op">(</span><span class="va">prior</span>, <span class="va">sensitivity</span>, <span class="va">specificity</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>prior</dt>
<dd><p>A numeric scalar.  The pre-test probability \(P(D)\) that the
person has the disease.  In the absence of specific information this could
be the prevalence of the disease in the population, that is, the
proportion of people who have the disease in the general population of
interest.</p></dd>


<dt>sensitivity</dt>
<dd><p>A numeric scalar.  The conditional probability that a
person who has the disease tests positive.  If \(+\) is the event that
the randomly chosen person tests positive then the sensitivity is
\(P(+ \mid D)\).</p></dd>


<dt>specificity</dt>
<dd><p>A numeric scalar.  The conditional probability that a
person who does not have the disease tests negative.  If \(-\) is the
event that the randomly chosen person test negative then the sensitivity
is \(P(- \mid {\rm not}D)\).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list containing the following components</p><ul><li><p><code>pp</code> The probability \(P(+)\) that the person will test positive.</p></li>
<li><p><code>ppv</code> The positive predictive value. The conditional probability
\(P(D \mid +)\) if the person tests positive then they has the disease.</p></li>
<li><p><code>npv</code> The negative predictive value. The conditional probability
\(P({\rm not}D \mid -)\) if the person tests negative
then they do not have the disease.</p></li>
<li><p><code>prior</code>,<code>sensitivity</code>,<code>specificity</code> The input values of <code>prior</code>,
<code>sensitivity</code> and <code>specificity</code>.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The required probabilities are calculated using the <strong>law of total
probability</strong>
$$P(+) = P(+ \mid D) P(D) + P(+ \mid {\rm not}D) P({\rm not}D)$$
and <strong>Bayes' theorem</strong>
$$P(D \mid +) = \frac{P(+ \mid D) P(D)}{P(+)}$$
$$P({\rm not}D \mid -) = \frac{P(- \mid {\rm not}D) P({\rm not}D)}{P(-)}.$$</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">screening_test</span><span class="op">(</span>prior <span class="op">=</span> <span class="fl">0.1</span>, sensitivity <span class="op">=</span> <span class="fl">0.9</span>, specificity <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prevalence, sensitivity, specificity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        P(D)     P(+ | D)  P(- | notD)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.1          0.9          0.9  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P(positive test), positive and negative predictive values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        P(+)     P(D | +)  P(notD | -)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0.1800       0.5000       0.9878  </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

